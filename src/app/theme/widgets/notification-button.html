<button mat-icon-button [matMenuTriggerFor]="menu">
  <mat-icon 
    [matBadge]="unreadCount" 
    [matBadgeHidden]="unreadCount === 0"
    matBadgeColor="warn" 
    aria-hidden="false">notifications</mat-icon>
</button>

<mat-menu #menu="matMenu">
  <mat-nav-list>
    @if (messages.length === 0) {
      <mat-list-item>
        <span matListItemTitle>No notifications</span>
      </mat-list-item>
    } @else {
      @for (message of messages; track message.id) {
        <mat-list-item [class.unread]="!message.read" (click)="markAsRead(message.id!)">
          <mat-icon class="m-x-16" matListItemIcon>
            {{ getIconForType(message.type) }}
          </mat-icon>
          <div matListItemTitle>{{ message.title }}</div>
          @if (message.message) {
            <div matListItemLine>{{ message.message }}</div>
          }
          @if (message.timestamp) {
            <div matListItemLine class="timestamp">{{ formatTimestamp(message.timestamp) }}</div>
          }
        </mat-list-item>
      }
    }
    @if (messages.length > 0) {
      <mat-divider></mat-divider>
      <mat-list-item (click)="clearMessages()">
        <mat-icon matListItemIcon>clear_all</mat-icon>
        <span matListItemTitle>Clear all</span>
      </mat-list-item>
    }
  </mat-nav-list>
</mat-menu>
